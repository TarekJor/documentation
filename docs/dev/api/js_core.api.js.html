<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: js/core.api.js</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":false,"cleverLinks":false,"outputSourceFiles":true,"outputSourcePath":true,"applicationName":"TagSpaces API","systemName":"TagSpaces API","navigationBackround":"#008000","footer":"","copyright":"Copyright Â© 2013-2016 The contributors to the TagSpaces project.","navType":"vertical","theme":"united","linenums":true,"collapseSymbols":false,"inverseNav":true,"highlightTutorialCode":true,"default":{"outputSourceFiles":true}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation" style="background-color: #008000"">
    <h3 class="applicationName"><a href="index.html">TagSpaces API</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="IOAPI">
            <span class="title">
                <a href="IOAPI.html">IOAPI</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IOAPI.ChromeExtension">
            <span class="title">
                <a href="IOAPI.ChromeExtension.html">IOAPI.ChromeExtension</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="IOAPI.ChromeExtension.checkNewVersion"><a href="IOAPI.ChromeExtension.html#.checkNewVersion">checkNewVersion</a></li>
            
                <li data-name="IOAPI.ChromeExtension.copyFilePromise"><a href="IOAPI.ChromeExtension.html#.copyFilePromise">copyFilePromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.createDirectoryPromise"><a href="IOAPI.ChromeExtension.html#.createDirectoryPromise">createDirectoryPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.createDirectoryTree"><a href="IOAPI.ChromeExtension.html#.createDirectoryTree">createDirectoryTree</a></li>
            
                <li data-name="IOAPI.ChromeExtension.deleteDirectoryPromise"><a href="IOAPI.ChromeExtension.html#.deleteDirectoryPromise">deleteDirectoryPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.deleteFilePromise"><a href="IOAPI.ChromeExtension.html#.deleteFilePromise">deleteFilePromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.getFileContentPromise"><a href="IOAPI.ChromeExtension.html#.getFileContentPromise">getFileContentPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.getPropertiesPromise"><a href="IOAPI.ChromeExtension.html#.getPropertiesPromise">getPropertiesPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.listDirectoryPromise"><a href="IOAPI.ChromeExtension.html#.listDirectoryPromise">listDirectoryPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.loadTextFilePromise"><a href="IOAPI.ChromeExtension.html#.loadTextFilePromise">loadTextFilePromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.openDirectory"><a href="IOAPI.ChromeExtension.html#.openDirectory">openDirectory</a></li>
            
                <li data-name="IOAPI.ChromeExtension.openFile"><a href="IOAPI.ChromeExtension.html#.openFile">openFile</a></li>
            
                <li data-name="IOAPI.ChromeExtension.renameDirectoryPromise"><a href="IOAPI.ChromeExtension.html#.renameDirectoryPromise">renameDirectoryPromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.renameFilePromise"><a href="IOAPI.ChromeExtension.html#.renameFilePromise">renameFilePromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.saveFilePromise"><a href="IOAPI.ChromeExtension.html#.saveFilePromise">saveFilePromise</a></li>
            
                <li data-name="IOAPI.ChromeExtension.selectDirectory"><a href="IOAPI.ChromeExtension.html#.selectDirectory">selectDirectory</a></li>
            
                <li data-name="IOAPI.ChromeExtension.selectFile"><a href="IOAPI.ChromeExtension.html#.selectFile">selectFile</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IOAPI.Cordova">
            <span class="title">
                <a href="IOAPI.Cordova.html">IOAPI.Cordova</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="IOAPI.Cordova.focusWindow
mthod"><a href="IOAPI.Cordova.html#.focusWindowmthod">focusWindow
mthod</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="IOAPI.Cordova.checkNewVersion"><a href="IOAPI.Cordova.html#.checkNewVersion">checkNewVersion</a></li>
            
                <li data-name="IOAPI.Cordova.copyFilePromise"><a href="IOAPI.Cordova.html#.copyFilePromise">copyFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.createDirectoryPromise"><a href="IOAPI.Cordova.html#.createDirectoryPromise">createDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Cordova.createDirectoryTree"><a href="IOAPI.Cordova.html#.createDirectoryTree">createDirectoryTree</a></li>
            
                <li data-name="IOAPI.Cordova.deleteDirectoryPromise"><a href="IOAPI.Cordova.html#.deleteDirectoryPromise">deleteDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Cordova.deleteFilePromise"><a href="IOAPI.Cordova.html#.deleteFilePromise">deleteFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.generateDirectoryTree"><a href="IOAPI.Cordova.html#.generateDirectoryTree">generateDirectoryTree</a></li>
            
                <li data-name="IOAPI.Cordova.getFileContentPromise"><a href="IOAPI.Cordova.html#.getFileContentPromise">getFileContentPromise</a></li>
            
                <li data-name="IOAPI.Cordova.getPropertiesPromise"><a href="IOAPI.Cordova.html#.getPropertiesPromise">getPropertiesPromise</a></li>
            
                <li data-name="IOAPI.Cordova.listDirectoryPromise"><a href="IOAPI.Cordova.html#.listDirectoryPromise">listDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Cordova.loadTextFilePromise"><a href="IOAPI.Cordova.html#.loadTextFilePromise">loadTextFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.openDirectory"><a href="IOAPI.Cordova.html#.openDirectory">openDirectory</a></li>
            
                <li data-name="IOAPI.Cordova.openFile"><a href="IOAPI.Cordova.html#.openFile">openFile</a></li>
            
                <li data-name="IOAPI.Cordova.renameDirectoryPromise"><a href="IOAPI.Cordova.html#.renameDirectoryPromise">renameDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Cordova.renameFilePromise"><a href="IOAPI.Cordova.html#.renameFilePromise">renameFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.saveBinaryFilePromise"><a href="IOAPI.Cordova.html#.saveBinaryFilePromise">saveBinaryFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.saveFilePromise"><a href="IOAPI.Cordova.html#.saveFilePromise">saveFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.saveTextFilePromise"><a href="IOAPI.Cordova.html#.saveTextFilePromise">saveTextFilePromise</a></li>
            
                <li data-name="IOAPI.Cordova.selectDirectory"><a href="IOAPI.Cordova.html#.selectDirectory">selectDirectory</a></li>
            
                <li data-name="IOAPI.Cordova.selectFile"><a href="IOAPI.Cordova.html#.selectFile">selectFile</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IOAPI.Electron">
            <span class="title">
                <a href="IOAPI.Electron.html">IOAPI.Electron</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="IOAPI.Electron.checkNewVersion"><a href="IOAPI.Electron.html#.checkNewVersion">checkNewVersion</a></li>
            
                <li data-name="IOAPI.Electron.copyFilePromise"><a href="IOAPI.Electron.html#.copyFilePromise">copyFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.createDirectoryPromise"><a href="IOAPI.Electron.html#.createDirectoryPromise">createDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Electron.createDirectoryTree"><a href="IOAPI.Electron.html#.createDirectoryTree">createDirectoryTree</a></li>
            
                <li data-name="IOAPI.Electron.deleteDirectoryPromise"><a href="IOAPI.Electron.html#.deleteDirectoryPromise">deleteDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Electron.deleteFilePromise"><a href="IOAPI.Electron.html#.deleteFilePromise">deleteFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.getFileContentPromise"><a href="IOAPI.Electron.html#.getFileContentPromise">getFileContentPromise</a></li>
            
                <li data-name="IOAPI.Electron.getPropertiesPromise"><a href="IOAPI.Electron.html#.getPropertiesPromise">getPropertiesPromise</a></li>
            
                <li data-name="IOAPI.Electron.listDirectoryPromise"><a href="IOAPI.Electron.html#.listDirectoryPromise">listDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Electron.listDirectoryPromiseAsync"><a href="IOAPI.Electron.html#.listDirectoryPromiseAsync">listDirectoryPromiseAsync</a></li>
            
                <li data-name="IOAPI.Electron.loadTextFilePromise"><a href="IOAPI.Electron.html#.loadTextFilePromise">loadTextFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.openDirectory"><a href="IOAPI.Electron.html#.openDirectory">openDirectory</a></li>
            
                <li data-name="IOAPI.Electron.openFile"><a href="IOAPI.Electron.html#.openFile">openFile</a></li>
            
                <li data-name="IOAPI.Electron.renameDirectoryPromise"><a href="IOAPI.Electron.html#.renameDirectoryPromise">renameDirectoryPromise</a></li>
            
                <li data-name="IOAPI.Electron.renameFilePromise"><a href="IOAPI.Electron.html#.renameFilePromise">renameFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.saveBinaryFilePromise"><a href="IOAPI.Electron.html#.saveBinaryFilePromise">saveBinaryFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.saveFilePromise"><a href="IOAPI.Electron.html#.saveFilePromise">saveFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.saveTextFilePromise"><a href="IOAPI.Electron.html#.saveTextFilePromise">saveTextFilePromise</a></li>
            
                <li data-name="IOAPI.Electron.selectDirectory"><a href="IOAPI.Electron.html#.selectDirectory">selectDirectory</a></li>
            
                <li data-name="IOAPI.Electron.selectFile"><a href="IOAPI.Electron.html#.selectFile">selectFile</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IOAPI.FirefoxAddon">
            <span class="title">
                <a href="IOAPI.FirefoxAddon.html">IOAPI.FirefoxAddon</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="IOAPI.FirefoxAddon.checkNewVersion"><a href="IOAPI.FirefoxAddon.html#.checkNewVersion">checkNewVersion</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.copyFilePromise"><a href="IOAPI.FirefoxAddon.html#.copyFilePromise">copyFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.createDirectory"><a href="IOAPI.FirefoxAddon.html#.createDirectory">createDirectory</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.createDirectoryPromise"><a href="IOAPI.FirefoxAddon.html#.createDirectoryPromise">createDirectoryPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.createDirectoryTree"><a href="IOAPI.FirefoxAddon.html#.createDirectoryTree">createDirectoryTree</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.deleteDirectoryPromise"><a href="IOAPI.FirefoxAddon.html#.deleteDirectoryPromise">deleteDirectoryPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.deleteFilePromise"><a href="IOAPI.FirefoxAddon.html#.deleteFilePromise">deleteFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.getFileContentPromise"><a href="IOAPI.FirefoxAddon.html#.getFileContentPromise">getFileContentPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.getPropertiesPromise"><a href="IOAPI.FirefoxAddon.html#.getPropertiesPromise">getPropertiesPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.listDirectoryPromise"><a href="IOAPI.FirefoxAddon.html#.listDirectoryPromise">listDirectoryPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.loadTextFilePromise"><a href="IOAPI.FirefoxAddon.html#.loadTextFilePromise">loadTextFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.openDirectory"><a href="IOAPI.FirefoxAddon.html#.openDirectory">openDirectory</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.openFile"><a href="IOAPI.FirefoxAddon.html#.openFile">openFile</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.renameDirectoryPromise"><a href="IOAPI.FirefoxAddon.html#.renameDirectoryPromise">renameDirectoryPromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.renameFilePromise"><a href="IOAPI.FirefoxAddon.html#.renameFilePromise">renameFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.saveBinaryFilePromise"><a href="IOAPI.FirefoxAddon.html#.saveBinaryFilePromise">saveBinaryFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.saveFilePromise"><a href="IOAPI.FirefoxAddon.html#.saveFilePromise">saveFilePromise</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.selectDirectory"><a href="IOAPI.FirefoxAddon.html#.selectDirectory">selectDirectory</a></li>
            
                <li data-name="IOAPI.FirefoxAddon.selectFile"><a href="IOAPI.FirefoxAddon.html#.selectFile">selectFile</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="IOAPI.WebDAV">
            <span class="title">
                <a href="IOAPI.WebDAV.html">IOAPI.WebDAV</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="TSCORE">
            <span class="title">
                <a href="TSCORE.html">TSCORE</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="TSCORE.initApp"><a href="TSCORE.html#.initApp">initApp</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="js_core.api.js.html">Source: js/core.api.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* Copyright (c) 2012-2017 The TagSpaces Authors. All rights reserved.
 * Use of this source code is governed by a AGPL3 license that
 * can be found in the LICENSE file. */
/*global isNode, isWin, isFirefox, Mousetrap, gui */

/**
 * Description
 * @class TSCORE
 */
define(function(require, exports, module) {
  'use strict';

  console.log('Loading core.api.js ...');

  // Importing modules
  var tsSettings = require('tssetting');
  var tsIOApi = require('tsioapi');
  var tsPersManager = require('tspersmanager');
  var tsTagUtils = require('tstagutils');
  var tsFileOpener = require('tsfileopener');
  var tsTagsUI = require('tstagsui');
  var tsDirectoriesUI = require('tsdirectoriesui');
  var tsCoreUI = require('tscoreui');
  var tsSearch = require('tssearch');
  var tsSearchUI = require('tssearchui');
  var tsPro = require('tspro');
  var tsUtils = require('tsutils');
  var tsIOUtils = require('tsioutils');
  var tsMeta = require('tsmeta');
  var tsExt = require('tsextapi');
  var tsExtManager = require('tsextmanager');
  var TSCORE = require('tscore');
  //var tsAudioRecorderUI = require('tsaudiorecorderui');
  var tsCalendarUI = require('tscalendarui');

  // Defining variables
  var currentPath;
  var currentLocationObject;
  var currentPerspectiveID;
  // Current selected files
  var selectedFiles = [];
  // Current directory list of files
  var fileList = [];
  // List of the sub directories of the current directory
  var subDirsList = [];
  // List of meta files
  var metaFileList = [];
  // Last clicked button for removing a tag
  var selectedTag = '';
  var selectedTagData = '';
  var startTime;
  var subfoldersDirBrowser;
  var directoryBrowser;

  // Loading animation related vars
  var $loadingAnimation = $('.loadingAnimation');
  var $statusBar = $('#statusBar');

  // UI and Layout functionalities
  var isFullWidth = false;
  var shouldOpenCol1 = true;
  var shouldOpenCol2 = true;
  var shouldOpenCol3 = false;
  var oneColumn = false;
  var saveOpenCol1 = false;

  /**
   * Initalizes the application
   * @memberof TSCORE
   * @method initApp
   */
  function initApp() {
    console.log('Init application');
    tsSettings.loadSettingsLocalStorage();
    checkLocalStorageEnabled();
    // In firefox, by empty local storage trying to load the settings from mozilla preferences
    if (tsSettings.Settings === undefined &amp;&amp; isFirefox) {
      window.setTimeout(tsIOApi.loadSettings, 1000);
      // executes initUI and updateSettingMozillaPreferences by success
      console.log('Loading setting with from mozilla pref executed with delay...');
    }
    // If still nothing found, loading the default setting from the application's javascript
    // This is usually the case by a new installation
    if (tsSettings.Settings === undefined) {
      tsSettings.Settings = tsSettings.DefaultSettings;
    }
    tsSettings.upgradeSettings();
    // Init UI components
    tsCoreUI.initUI();
    tsTagsUI.initUI();
    tsTagsUI.generateTagGroups();
    tsDirectoriesUI.initUI();
    tsDirectoriesUI.initLocations();
    tsFileOpener.initUI();
    tsSearchUI.initUI();
    //tsAudioRecorderUI.initUI();
    tsExtManager.loadExtensionData().then(function() {
      tsPersManager.initPerspectives().then(function(result) {
        console.log("Perspectives Initialized: " + result);
      }).catch(function(err) {
        console.warn("Perspectives initialization failed: " + err);
      });
    });

    hideLoadingAnimation();

    $(document).ready(function() {
      reLayout();

      var language = tsSettings.getInterfaceLanguage();

      if (tsSettings.isFirstRun()) {
        // Showing license dialog
        tsCoreUI.showLicenseDialog();

        // Setting the language
        var browserLang = navigator.language || navigator.userLanguage;

        var languageMatched;

        tsSettings.getSupportedLanguages().forEach(function(value) {
          if (browserLang === value.iso) {
            language = browserLang;
            languageMatched = true;
          }
        });

        if (!languageMatched) {
          tsSettings.getSupportedLanguages().forEach(function(value) {
            if (value.iso.indexOf(browserLang) === 0) {
              language = value.iso;
            }
          });
        }

        tsSettings.setInterfaceLanguage(language);
        tsSettings.saveSettings();

      }

      var langURLParam = tsUtils.getURLParameter('locale');
      if (langURLParam &amp;&amp; langURLParam.length > 1) {
        language = langURLParam;
      }

      switchInterfaceLanguage(language).then(function() {
        if (isNode || isElectron) {
          tsIOApi.initMainMenu();
        }

        if (tsSettings.Settings.tagspacesList.length &lt; 1) {
          // Show getting started guide by no locations
          tsCoreUI.startGettingStartedTour();
        }
      }).catch(function() {
        console.warn("Language switching failed.");
      });

      initKeyBindings();
      tsIOApi.checkAccessFileURLAllowed ? tsIOApi.checkAccessFileURLAllowed() : true;

      console.log('Document ready finished. Layout initialized');
      checkForNewVersion();
    });

    window.addEventListener('orientationchange', reLayout);

    $(window).on('resize', reLayout);

    applyCustomStyles();
  }

  function applyCustomStyles() {
    var sheet = document.createElement('style');
    sheet.innerText = ".tagButton {color: " + TSCORE.Config.getDefaultTagTextColor() + " !important; background: " + TSCORE.Config.getDefaultTagColor() + " !important;}";
    document.body.appendChild(sheet);
  }

  function switchInterfaceLanguage(language) {
    exports.currentLanguage = language;
    return new Promise(function(resolve, reject) {
      $.i18n.init({
        ns: {
          namespaces: [
            'ns.common',
            'ns.dialogs',
            'ns.perspectives',
            'ns.pro',
          ]
        },
        lng: language,
        debug: true,
        fallbackLng: 'en_US'
      }, function() {
        $('[data-i18n]').i18n();
        resolve();
      });
    });
  }

  function initKeyBindings() {
    if (isNode) {
      var win = gui.Window.get();
      Mousetrap.bind(tsSettings.getOpenDevToolsScreenKeyBinding(), function() {
        win.showDevTools();
      });
      Mousetrap.bind(tsSettings.getReloadApplicationKeyBinding(), function() {
        win.reloadIgnoringCache();
      });
      Mousetrap.bind(tsSettings.getToggleFullScreenKeyBinding(), function() {
        win.toggleFullscreen();
      });
    }
    Mousetrap.bind(tsSettings.getShowTagLibraryKeyBinding(), function() {
      tsCoreUI.showTagsPanel();
    });
    Mousetrap.bind(tsSettings.getShowFolderNavigatorBinding(), function() {
      tsCoreUI.showLocationsPanel();
    });
    Mousetrap.bind(tsSettings.getAddRemoveTagsKeyBinding(), function() {
      tsTagsUI.showAddTagsDialog();
    });
    Mousetrap.bind(tsSettings.getSearchKeyBinding(), function() {
      tsSearchUI.showSearchArea();
    });
    Mousetrap.bind(tsSettings.getRenamingFileKeyBinding(), function() {
      tsCoreUI.showFileRenameDialog(TSCORE.selectedFiles[0]);
    });
    Mousetrap.bind(tsSettings.getDeleteDocumentKeyBinding(), function() {
      tsCoreUI.showDeleteFilesDialog();
    });
    Mousetrap.bind(tsSettings.getOpenFileKeyBinding(), function() {
      tsFileOpener.openFile(TSCORE.selectedFiles[0]);
    });
    Mousetrap.bind(tsSettings.getOpenFileExternallyKeyBinding(), function() {
      TSCORE.IO.openFile(TSCORE.selectedFiles[0]);
    });
  }

  function checkForNewVersion() {
    if (tsSettings.getCheckForUpdates()) {
      tsIOApi.checkNewVersion();
    }
  }

  function checkLocalStorageEnabled() {
    var val = 'tagspaces';
    try {
      localStorage.setItem(val, val);
      localStorage.removeItem(val);
    } catch (e) {
      tsCoreUI.showAlertDialog($.i18n.t('ns.dialogs:enableLocalStorageAlert'), 'Error');
    }
  }

  function updateNewVersionData(data) {
    console.log('Version Information: ' + JSON.stringify(data));
    var versioningData = JSON.parse(JSON.stringify(data));
    // Analysing Version Information
    var availableBuild = parseInt(versioningData.appBuild);
    var verA = versioningData.appVersion.split('.');
    if (verA[1].length == 1) {
      verA[1] = '0' + verA[1];
    }
    var availableVersion = parseFloat(verA[0] + '.' + verA[1]);
    var currentBuild = parseInt(tsSettings.DefaultSettings.appBuild);
    var verC = tsSettings.DefaultSettings.appVersion.split('.');
    if (verC[1].length == 1) {
      verC[1] = '0' + verC[1];
    }
    var currentVersion = parseFloat(verC[0] + '.' + verC[1]);
    /* Testing the new version notifications

     availableVersion = 2;
     currentVersion = 1;
     availableBuild = 2;
     currentBuild = 1; */
    if (availableVersion > currentVersion || availableVersion == currentVersion &amp;&amp; availableBuild > currentBuild) {
      $('#newVersionAvailable').css('display', 'block');
      /*$('#whatsNewModal iframe').attr('src', 'http://tagspaces.org/whatsnew/');
       $('#whatsNewModal').on('show.bs.modal', function(e) {
       $('#whatsNewModal iframe').attr('src', 'http://tagspaces.org/whatsnew/');
       });*/
    }
  }

  function showLoadingAnimation() {
    $statusBar.hide();
    $loadingAnimation.show();
  }

  function hideLoadingAnimation() {
    setTimeout(function() {
      $loadingAnimation.hide();
      $statusBar.show();
    }, 500);
  }

  function removeFileModel(model, filePath) {
    console.log('Removing file from model');
    for (var i = 0; i &lt; model.length; i++) {
      if (model[i].path === filePath) {
        model.splice(i, 1);
      }
    }
  }

  function updateFileModel(model, oldPath, newPath) {
    console.log('Updating file from model');
    var title = tsTagUtils.extractTitle(newPath),
      fileExt = tsTagUtils.extractFileExtension(newPath),
      fileTags = tsTagUtils.extractTags(newPath);
    for (var i = 0; i &lt; model.length; i++) {
      if (model[i].path == oldPath) {
        model[i].path = newPath;
        model[i].title = title;
        model[i].tags = fileTags;
        model[i].extension = fileExt; // TODO complete the list
      }
    }
  }

  function exportFileListCSV(fileList) {
    var csv = '';
    var headers = [];
    var rows = [];
    var numberOfTagColumns = 40;
    // max. estimated to 40 ca. 5 symbols per tag _[er], max. path length 25x chars
    headers.push('path');
    headers.push('title');
    headers.push('changed_date');
    headers.push('size');
    for (var i = 0; i &lt; numberOfTagColumns; i++) {
      headers.push('tag' + i);
    }
    csv += headers.join(',') + '\n';
    for (var i = 0; i &lt; fileList.length; i++) {
      var lmtd = "";
      try {
        lmtd = (new Date(fileList[i].lmdt)).toISOString();
      } catch (e) {
        console.log("error parsing lmdt date");
      }
      var row = fileList[i].path + ',' + fileList[i].title + ',' + lmtd + ',' + fileList[i].size + ',' + fileList[i].tags;
      rows.push(row);
    }
    csv += rows.join('\n');
    return csv;
  }

  function exportFileListArray(fileList) {
    var rows = [];
    for (var i = 0; i &lt; fileList.length; i++) {
      var row = [];
      row.path = fileList[i].path;
      row.title = fileList[i].title;
      row.size = fileList[i].size;
      for (var j = 0; j &lt; fileList[i].tags.length; j++) {
        row['tag' + j] = tags[j];
      }
      rows.push(row);
    }
    return rows;
  }

  function isOneColumn() {

    return oneColumn;
  }

  function reLayout() {
    //console.log("Window w: "+window.innerWidth+" h: "+window.innerHeight+" orient: "+window.orientation+" dpi: "+window.devicePixelRatio);
    var fullWidth = window.innerWidth;
    var halfWidth = Math.round(window.innerWidth / 2);
    var isPortret = fullWidth &lt; window.innerHeight;
    oneColumn = fullWidth &lt; 660;
    var twoColumn = fullWidth >= 660 &amp;&amp; fullWidth &lt; 1024;

    $("#searchOptions").hide();

    showPerspectiveMenu();
    tsCoreUI.hideAllDropDownMenus();

    if (isFullWidth) {
      oneColumn = true;
    }
    if (oneColumn) {
      if (shouldOpenCol3) {
        shouldOpenCol1 = false;
        shouldOpenCol2 = false;
      } else if (shouldOpenCol1) {
        shouldOpenCol1 = true;
        shouldOpenCol2 = true;
        shouldOpenCol3 = false;
        hidePerspectiveMenu();
      } else {
        shouldOpenCol2 = true;
      }
      if (!isFullWidth) {
        $('#toggleFullWidthButton').hide();
      }
    } else if (twoColumn) {
      $("#openLeftPanel").show();
      shouldOpenCol2 = true;
      if (shouldOpenCol3) {
        shouldOpenCol1 = false;
        shouldOpenCol3 = true;
      }
    } else { // three column
      $('#toggleFullWidthButton').show();
      if (isFullWidth) {
        shouldOpenCol1 = false;
        shouldOpenCol2 = false;
        shouldOpenCol3 = true;
      } else {
        shouldOpenCol2 = true;
      }
    }

    if (shouldOpenCol1) {
      $("#openLeftPanel").hide();
      $("#closeLeftPanel").show();
      $(".col1").show();
    } else {
      $("#closeLeftPanel").hide();
      $("#openLeftPanel").show();
      $(".col1").hide();
    }

    if (shouldOpenCol2) {
      $(".col2").show();
    } else {
      $(".col2").hide();
    }

    if (shouldOpenCol3) {
      $(".col3").show();
      hidePerspectiveMenu();
    } else {
      $(".col3").hide();
    }
  }

  function hidePerspectiveMenu() {
    $(".perspectiveMainMenuButton").hide();
  }

  function showPerspectiveMenu() {

    $(".perspectiveMainMenuButton").show();
  }

  function openFileViewer() {
    shouldOpenCol3 = true;
    saveOpenCol1 = shouldOpenCol1;
    reLayout();
  }

  function closeFileViewer() {
    shouldOpenCol3 = false;
    isFullWidth = false;
    reLayout();
  }

  function toggleFullWidth() {
    isFullWidth = !isFullWidth;
    shouldOpenCol1 = saveOpenCol1;
    reLayout();
  }

  function closeLeftPanel() {
    shouldOpenCol1 = false;
    reLayout();
  }

  function openLeftPanel() {
    shouldOpenCol1 = true;
    reLayout();
  }

  function reloadUI() {
    location.reload();
  }

  function createDocumentEvent(type, data) {
    var evt = document.createEvent('Events');
    evt.initEvent(type, false, false);
    return evt;
  }

  function fireDocumentEvent(evt) {
    setTimeout(function() {
      document.dispatchEvent(evt);
    }, 0);
  }

  // Proxying applications parts
  exports.Config = tsSettings;
  exports.IO = tsIOApi;
  exports.IOUtils = tsIOUtils;
  exports.UI = tsCoreUI;
  exports.PerspectiveManager = tsPersManager;
  exports.TagUtils = tsTagUtils;
  exports.FileOpener = tsFileOpener;
  exports.Search = tsSearch;
  exports.Calendar = tsCalendarUI;
  exports.Utils = tsUtils;
  if (tsPro.available) {
    exports.PRO = tsPro;
  }
  exports.Meta = tsMeta;

  // Public API definition
  exports.dirSeparator = isWin &amp;&amp; !isWeb ? '\\' : '/';
  exports.metaFolder = ".ts";
  exports.metaFolderFile = "tsm.json";
  exports.metaFileExt = ".json";
  exports.thumbFileExt = ".png";
  exports.contentFileExt = ".txt";
  exports.directoryExt = "DIRECTORY";
  exports.locationDesktop;
  exports.initApp = initApp;
  exports.reLayout = reLayout;
  exports.isOneColumn = isOneColumn;
  exports.showLoadingAnimation = showLoadingAnimation;
  exports.hideLoadingAnimation = hideLoadingAnimation;
  exports.reloadUI = reloadUI;
  exports.reLayout = reLayout;
  exports.openFileViewer = openFileViewer;
  exports.closeFileViewer = closeFileViewer;
  exports.openLeftPanel = openLeftPanel;
  exports.closeLeftPanel = closeLeftPanel;
  exports.toggleFullWidth = toggleFullWidth;
  exports.updateNewVersionData = updateNewVersionData;
  exports.exportFileListCSV = exportFileListCSV;
  exports.exportFileListArray = exportFileListArray;
  exports.removeFileModel = removeFileModel;
  exports.updateFileModel = updateFileModel;
  exports.switchInterfaceLanguage = switchInterfaceLanguage;

  // Proxying functions from tsCoreUI
  exports.enableTopToolbar = tsCoreUI.enableTopToolbar;
  exports.disableTopToolbar = tsCoreUI.disableTopToolbar;
  exports.showAlertDialog = tsCoreUI.showAlertDialog;
  exports.showSuccessDialog = tsCoreUI.showSuccessDialog;
  exports.showConfirmDialog = tsCoreUI.showConfirmDialog;
  exports.hideAllDropDownMenus = tsCoreUI.hideAllDropDownMenus;
  exports.showFileCreateDialog = tsCoreUI.showFileCreateDialog;
  exports.showFileRenameDialog = tsCoreUI.showFileRenameDialog;
  exports.showFileDeleteDialog = tsCoreUI.showFileDeleteDialog;
  exports.showLocationsPanel = tsCoreUI.showLocationsPanel;
  exports.showTagsPanel = tsCoreUI.showTagsPanel;
  exports.showContextMenu = tsCoreUI.showContextMenu;
  exports.showDirectoryBrowserDialog = tsCoreUI.showDirectoryBrowserDialog;
  exports.createHTMLFile = tsCoreUI.createHTMLFile;
  exports.createMDFile = tsCoreUI.createMDFile;
  exports.createTXTFile = tsCoreUI.createTXTFile;
  exports.showRenameFileDialog = tsCoreUI.showRenameFileDialog;

  // Proxying functions from tsSearchUI
  exports.clearSearchFilter = tsSearchUI.clearSearchFilter;
  exports.showSearchArea = tsSearchUI.showSearchArea;
  exports.searchForTag = tsSearchUI.searchForTag;

  // Proxying functions from tsTagsUI
  exports.generateTagButtons = tsTagsUI.generateTagButtons;
  exports.generateTagStyle = tsTagsUI.generateTagStyle;
  exports.openTagMenu = tsTagsUI.openTagMenu;
  exports.showWaitingDialog = tsCoreUI.showWaitingDialog;
  exports.hideWaitingDialog = tsCoreUI.hideWaitingDialog;
  exports.showMoveCopyFilesDialog = tsCoreUI.showMoveCopyFilesDialog;
  exports.showAddTagsDialog = tsTagsUI.showAddTagsDialog;
  exports.showTagEditInTreeDialog = tsTagsUI.showTagEditInTreeDialog;
  exports.showDialogTagCreate = tsTagsUI.showDialogTagCreate;
  exports.showDialogEditTagGroup = tsTagsUI.showDialogEditTagGroup;
  exports.showDialogTagGroupCreate = tsTagsUI.showDialogTagGroupCreate;
  exports.calculatedTags = tsTagsUI.calculatedTags;
  exports.locationTags = tsTagsUI.locationTags;
  exports.generateTagGroups = tsTagsUI.generateTagGroups;

  // Proxying functions from directoriesUI
  exports.openLocation = tsDirectoriesUI.openLocation;
  exports.updateSubDirs = tsDirectoriesUI.updateSubDirs;
  exports.initLocations = tsDirectoriesUI.initLocations;
  exports.showCreateDirectoryDialog = tsDirectoriesUI.showCreateDirectoryDialog;
  exports.closeCurrentLocation = tsDirectoriesUI.closeCurrentLocation;
  exports.navigateToDirectory = tsDirectoriesUI.navigateToDirectory;
  exports.generateFolderTags = tsDirectoriesUI.generateFolderTags;

  // Public variables definition
  exports.currentPath = currentPath;
  exports.currentLanguage = exports.currentLanguage;
  exports.currentLocationObject = currentLocationObject;
  exports.currentPerspectiveID = currentPerspectiveID;
  exports.selectedFiles = selectedFiles;
  exports.fileList = fileList;
  exports.subDirsList = subDirsList;
  exports.selectedTag = selectedTag;
  exports.selectedTagData = selectedTagData;
  exports.startTime = startTime;
  exports.subfoldersDirBrowser = subfoldersDirBrowser;
  exports.directoryBrowser = directoryBrowser;

  //document events
  exports.createDocumentEvent = createDocumentEvent;
  exports.fireDocumentEvent = fireDocumentEvent;
  exports.metaFileList = metaFileList;
});
</code></pre>
        </article>
    </section>






        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Mar 27 2017 23:48:40 GMT+0200 (CEST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
